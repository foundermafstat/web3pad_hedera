# W3P — Web3Pad Hedera Gaming Platform

**Превратите любой экран в мгновенную мультиплеерную игровую арену с интеграцией блокчейна Hedera. Ваш смартфон — это ваш контроллер.**

Никаких загрузок. Никаких установок. Никакой возни.
Просто отсканируйте QR-код, играйте и соревнуйтесь с друзьями за считанные секунды!

---

## Содержание

- [Основные возможности](#-основные-возможности)
- [Launchpad-функциональность и переход Web2 → Web3](#-launchpad-функциональность-и-переход-web2--web3)

  - [Launchpad для игровых компаний](#-launchpad-для-игровых-компаний)
  - [Система контрактов Launchpad](#система-контрактов-launchpad)

- [Стратегия перехода Web2 → Web3](#-стратегия-перехода-web2--web3)
- [Быстрый старт](#-быстрый-старт)
- [Архитектура системы](#️-архитектура-системы)
- [Встроенные игры](#-встроенные-игры)
- [Смарт-контракты Hedera](#-смарт-контракты-hedera)
- [Токен-экономика](#-токен-экономика)
- [Кошельки и авторизация](#-кошельки-и-авторизация)
- [API и интеграция контрактов](#-api-и-интеграция-контрактов)
- [Функции безопасности контрактов](#️-безопасность)
- [Технологический стек](#-технологический-стек)
- [Тестирование контрактов](#-тестирование)
- [Мониторинг](#-мониторинг)
- [Use Cases](#-use-cases)
- [Roadmap](#-roadmap)
- [Contributing](#-contributing)
- [Лицензия](#-лицензия)
- [Поддержка](#-поддержка)

---

## Основные возможности

Проект представляет собой полнофункциональную платформу для мультиплеерных игр с глубокой интеграцией блокчейна Hedera, включая токены, NFT, лотерею и систему достижений.

**Нулевая настройка** — никаких приложений для установки. Всё работает прямо в браузере.
**Телефон = контроллер** — отсканируйте QR-код, и ваш телефон мгновенно становится геймпадом.
**Локальная сеть** — ультранизкая задержка: ваши данные не покидают вашу сеть.
**До 10 игроков** — идеально для вечеринок, тимбилдинга и семейных игровых вечеров.
**Красивая графика** — работает на PixiJS v8 для плавного 60 FPS-геймплея.

---

## Launchpad-функциональность и переход Web2 → Web3

### Launchpad для игровых компаний

W3P также выполняет роль **Launchpad-платформы**, предоставляя игровым компаниям инструменты для внедрения Web3 через смарт-контракт **HederaGameLaunchpad** — главный оркестратор экосистемы.

**Основные функции:**

1. **Регистрация игр** — `registerGameModule()`
2. **Верификация результатов** — `submitGameResult()`
3. **Игровая идентичность (SBT)** — `mintPlayerSBT()`
4. **NFT-достижения** — `mintAchievementNFT()`
5. **Токен-экономика** — `swapHBARforHPLAY()`
6. **Лотерея** — `executeLotteryDraw()`

---

### Система контрактов Launchpad (Core Contract System)

| Контракт                | Назначение                                |
| ----------------------- | ----------------------------------------- |
| **HederaGameLaunchpad** | Главный оркестратор                       |
| **GameRegistry**        | Регистрация и авторизация игровых модулей |
| **ResultVerifier**      | Проверка результатов                      |
| **PlayerSBT**           | SoulBound-токены игроков                  |
| **NFTManager**          | Управление NFT-достижениями               |
| **TokenEconomy**        | HPLAY-токен и стейкинг                    |
| **FaucetManager**       | Конвертация HBAR → HPLAY                  |
| **LotteryPool**         | Лотерея, финансируемая комиссиями         |

---

## Стратегия перехода Web2 → Web3

W3P упрощает интеграцию Web3-функций в традиционные Web2-игры, не требуя полной переработки логики.

### Фазы интеграции:

1. **Создание игры (Off-chain)** — логика и физика выполняются на сервере.
2. **Регистрация сессии (On-chain)** — запись данных о матчах в Hedera.
3. **Верификация результатов (Гибрид)** — подпись сервером, проверка на блокчейне.
4. **NFT-достижения (On-chain)** — чеканка NFT с метаданными достижений.

### Бесшовная авторизация

- Вход через **email/OAuth** (Google, GitHub)
- Поддержка **HashPack**, **Blade**, **WalletConnect**
- Автоматическое создание аккаунтов (`hedera_0_0_xxx`)

---

## Быстрый старт

### Предварительные требования

- Node.js 18+
- npm или pnpm
- Аккаунт Hedera Testnet с HBAR (для блокчейн функций)

### Установка

1. **Клонируйте репозиторий:**

```bash
git clone https://github.com/foundermafstat/web3pad_hedera.git
cd web3pad_hedera
```

2. **Установите зависимости:**

```bash
npm install
```

3. **Настройте переменные окружения:**

Скопируйте файл примера и заполните значения:

```bash
cp .env.example .env
```

**Серверные переменные:**

```env
HEDERA_ACCOUNT_ID=0.0.123456
HEDERA_PRIVATE_KEY=your_private_key_here
HEDERA_JSON_RPC_URL=https://testnet.hashio.io/api
DATABASE_URL=postgresql://username:password@localhost:5432/w3p_db
JWT_SECRET=your_jwt_secret_here
```

**Клиентские переменные:**

```env
NEXT_PUBLIC_WALLETCONNECT_PROJECT_ID=your_project_id_here
```

4. **Запустите сервер разработки:**

```bash
# Запустить сервер (порт 3001)
cd server
node server.js

# В новом терминале - запустить клиент (порт 3000)
cd client
npm run dev
```

---

## Архитектура системы

### Обзор компонентов

Платформа состоит из трех основных слоев:

```
├── client/                    # Next.js фронтенд приложение
│   ├── app/                   # Next.js App Router страницы
│   ├── components/            # React компоненты
│   ├── contexts/              # React контексты (WalletContext)
│   ├── lib/                   # Утилиты (HederaService, API клиенты)
│   └── hooks/                 # Пользовательские React hooks
│
├── server/                    # Node.js + Express бэкенд
│   ├── lib/                   # Сервисы (ContractService, TransactionService)
│   ├── routes/                # API маршруты
│   ├── games/                 # Игровая логика
│   └── prisma/                # База данных и схемы
│
└── contracts/                 # Hedera смарт-контракты
    ├── contracts/             # Solidity контракты
    ├── scripts/               # Скрипты развертывания
    └── test/                  # Тесты контрактов
```

### Блокчейн интеграция

Платформа интегрируется с Hedera Hashgraph через несколько ключевых компонентов:

**Серверная интеграция:**

- `ContractService` - Операции чтения из смарт-контрактов
- `TransactionService` - Операции записи и выполнение транзакций
- Двойной подход: Hedera SDK для простых запросов, JSON-RPC для сложных возвратов

**Клиентская интеграция:**

- `HederaService` - Singleton сервис для операций с кошельками Hedera
- `WalletContext` - React контекст для глобального состояния кошелька
- Поддержка трех методов подключения: WalletConnect, HashPack, Blade

**Ключевые компоненты:**

- `ContractService` — взаимодействие с контрактами
- `TransactionService` — выполнение транзакций
- `WalletContext` — глобальное состояние кошелька
- `HederaService` — API для операций с Hedera

---

## Встроенные игры

| Игра              | Жанр         | Игроков | Описание                            |
| ----------------- | ------------ | ------- | ----------------------------------- |
| **Battle Arena**  | Шутер сверху | 2–10    | PvE-экшен с AI-ботами               |
| **Race Track**    | Гонки        | 2–10    | Реальные гонки с чекпоинтами        |
| **Tower Defence** | Стратегия    | 1–4     | Кооп-защита базы от волн врагов     |
| **Quiz Game**     | Викторина    | 2–10    | Интерактивная интеллектуальная игра |

---

## Смарт-контракты Hedera

Восемь смарт-контрактов развернуты на Hedera Testnet:
| Контракт | Адрес | Назначение |
| ------------------- | -------------------------------------------- | -------------------- |
| GameRegistry | `0xdA0cBEaE027b044648386e4c27e20C18257C885A` | Регистрация игр |
| TokenEconomy | `0x23f6bb3a2c8babee952e0443b6b7350aa85d6ab9` | HPLAY токен |
| LotteryPool | `0x9BB862643a73725E636dD7d7E30306844aA099f3` | Лотерея |
| PlayerSBT | `0xfe9CF4dde9fBc14d61D26703354AA10414B35Ea6` | SoulBound токены |
| NFTManager | `0x01Af1C62098d0217dEE7bC8A72dd93fa6D02b860` | NFT достижения |
| FaucetManager | `0xe334AfEc78B410C953A9bEa0Ff1E55F74bdeC212` | Faucet система |
| ResultVerifier | `0xb1583369fe74FBf2D9b87B870FE67D6D0DC13b84` | Проверка результатов |
| HederaGameLaunchpad | `0x54d13a05C632738674558f18De4394b7Ee9A0399` | Главный контракт |

---

## Токен-экономика

- **Токен:** Hedera Play Token (HPLAY)
- **Decimals:** 8
- **Объем:** 10 000 000 000 HPLAY

**Распределение:**

- 40% — Пул наград игрокам
- 20% — Стимулы разработчикам
- 20% — DAO-казна
- 10% — Маркетинговые события
- 10% — Резерв ликвидности

**NFT-достижения:**

- Common — 10 HPLAY
- Rare — 50 HPLAY
- Epic — 200 HPLAY
- Legendary — 1000 HPLAY

---

## Кошельки и авторизация

Поддержка: **WalletConnect**, **HashPack**, **Blade**

- Подпись транзакций на клиенте
- Автоматическое восстановление сессий
- Mainnet/Testnet совместимость

---

### Провайдеры Hedera кошельков

Поддерживаются три метода подключения с автоматическим переключением:

1. **WalletConnect** - Кросс-платформенное подключение мобильных кошельков через сканирование QR-кода
2. **HashPack** - Расширение браузера с прямой интеграцией
3. **Blade** - Расширение браузера с прямой интеграцией

---

### Глобальное состояние кошелька

`WalletContext` предоставляет глобальное состояние кошелька во всем приложении:

**Основные свойства состояния:**

- `isConnected` - Подключен ли кошелек
- `walletAddress` - Адрес подключенного кошелька
- `walletType` - Используемый метод подключения
- `network` - Активная сеть (mainnet/testnet)
- `dAppConnector` - Экземпляр WalletConnect DAppConnector
- `currentSession` - Активная WalletConnect сессия

---

## API и интеграция контрактов

## API интеграция контрактов

### Эндпоинты системы

- `GET /api/contracts/system/stats` - Получить статистику системы
- `GET /api/contracts/system/operational` - Проверить статус системы

### Эндпоинты игроков

- `GET /api/contracts/player/:address/info` - Полная информация об игроке
- `GET /api/contracts/player/:address/stats` - Статистика игрока
- `GET /api/contracts/player/:address/sbt` - Статус SBT
- `GET /api/contracts/player/:address/nft-count` - Количество NFT

### Эндпоинты токенов

- `GET /api/contracts/token/balance/:address` - Баланс токенов
- `GET /api/contracts/token/supply` - Общий объем
- `GET /api/contracts/token/staked/:address` - Застейканный баланс

### Эндпоинты обмена

- `POST /api/swap/create-transaction` - Создать неподписанную транзакцию обмена
- `POST /api/swap/submit-transaction` - Отправить подписанную транзакцию
- `GET /api/swap/rate` - Получить курс обмена
- `GET /api/swap/balance/:address` - Баланс HBAR

---

### Функции безопасности контрактов

- **Ролевой контроль доступа:** Owner, DAO, Server и Game Server роли
- **Защита от реентрантности:** Все внешние вызовы защищены
- **Верификация подписей:** ECDSA подписи с защитой от повторного воспроизведения
- **Валидация Nonce:** Монотонная система nonce предотвращает повторные атаки
- **Валидация временных меток:** Истечение срока действия подписей
- **Функция паузы:** Аварийная пауза для всех контрактов
- **Валидация входных данных:** Комплексная проверка параметров

---

### Подпись транзакций на стороне клиента

Платформа реализует паттерн **подписи на стороне клиента**, где пользователи подписывают транзакции своими кошельками, обеспечивая хранение приватных ключей.

Процесс включает:

1. Создание транзакции на сервере
2. Заморозка транзакции с пользователем как плательщиком
3. Подпись пользователем через WalletConnect/HashPack/Blade
4. Отправка подписанной транзакции на выполнение

---

## Технологический стек

**Backend:**

- Node.js - Среда выполнения
- Express - Веб-сервер фреймворк
- Socket.io - Двунаправленная коммуникация в реальном времени
- Hedera SDK - Интеграция с блокчейном Hedera
- Prisma - ORM для базы данных
- PostgreSQL - Реляционная база данных

**Frontend:**

- Next.js 16 - React фреймворк с App Router
- React 19 - UI библиотека
- TypeScript - Типизация
- TailwindCSS 4 - Utility-first стилизация
- NextAuth - Аутентификация и управление сессиями

**Game Engine:**

- PixiJS v8 - Высокопроизводительный 2D WebGL рендеринг
- 60 FPS игровой цикл с delta time расчетами

**Блокчейн:**

- Hedera Hashgraph - Testnet
- Solidity - Язык смарт-контрактов
- Hardhat - Разработка и тестирование контрактов
- ethers.js - Взаимодействие с контрактами

---

## Тестирование контрактов

### Тестирование контрактов

```bash
cd contracts
npm test                    # Запустить все тесты
npm run test:coverage       # Запустить с покрытием
```

Набор тестов включает:

- **Unit тесты:** Функциональность отдельных контрактов
- **Интеграционные тесты:** Взаимодействие между контрактами
- **Тесты безопасности:** Контроль доступа и валидация
- **Gas тесты:** Верификация оптимизации

### Тестирование интеграции

```bash
# Тест взаимодействия с контрактами
node server/scripts/test-contracts.js

# Быстрые тесты
npm run test:fast
```

---

## Мониторинг

### Ключевые метрики

- Всего сыгранных игр
- Активных игроков
- Распределено HPLAY
- Баланс лотерейного пула
- Отчеканено NFT
- Статус здоровья системы

### События

Все основные операции генерируют события для мониторинга:

```solidity
event GameResultVerified(address indexed player, string indexed gameId, uint256 score);
event PlayerSBTMinted(address indexed player, uint256 tokenId);
event NFTMinted(address indexed player, uint256 tokenId, string achievementType);
event LotteryWinner(address indexed winner, uint256 prizeAmount);
```

---

## Use Cases

**Идеально для:**

- **Домашних вечеринок** - мгновенное развлечение для гостей
- **Корпоративных мероприятий** - командообразующие активности
- **Семейных встреч** - развлечение для всех возрастов
- **Площадок для мероприятий** - интерактивные игровые зоны
- **Школ** - образовательные игровые сессии
- **Игровых кафе** - не требуется обслуживание контроллеров

---

## Roadmap

**Скоро:**

- Больше типов игр (пазлы, платформеры, файтинги)
- Пользовательские игровые комнаты с паролями
- Профили игроков и статистика
- Система воспроизведения
- Режим зрителя
- Турнирные сетки
- Пользовательские скины и темы
- Кросс-игровая совместимость
- Интеграция Layer-2 масштабирования
- Децентрализованная генерация случайных чисел
- Реализация токена управления

---

## Contributing

Приветствуются:

- Добавление новых игр
- Исправление ошибок
- Улучшение документации
- Улучшение UI/UX

Не стесняйтесь открывать issues и pull requests.

---

## Поддержка

**Если у вас возникли вопросы, предложения или проблемы:**

- Создайте issue в репозитории
- Ознакомьтесь с документацией
- Изучите тест-кейсы для примеров использования

**Свяжитесь с нами в соцсетях:**

**Ihor Sokolov:**

- 💬 [Telegram](https://t.me/iampublion)
- 🐦 [Twitter](https://x.com/ampublion)
- 🌐 [Linkedin](https://linkedin.com/in/mafstat)

**Irina Semichasova:**

- 💬 [Telegram](https://t.me/irine7)
- 🐦 [Twitter](https://x.com/irine_es)
- 🌐 [Linkedin](https://linkedin.com/in/irina-semichasova)

---

## Лицензия

**Copyright © 2025 Ihor Sokolov (foundermafstat) & Irina Semichasova (Irine7), Web3Pad Team (All Rights Reserved)**
